[31m[Nest] 8232  - [39m02/12/2025, 9:56:54 a.¬†m. [31m  ERROR[39m [38;5;3m[WooCommerceSyncService] [39m[31mFailed to process order 1[39m
DB Error
[31m[Nest] 8232  - [39m02/12/2025, 9:56:59 a.¬†m. [31m  ERROR[39m [38;5;3m[WooCommerceSyncService] [39m[31mFailed to create contact for order 1[39m
Database error
[31m[Nest] 8232  - [39m02/12/2025, 9:56:59 a.¬†m. [31m  ERROR[39m [38;5;3m[WooCommerceSyncService] [39m[31mFailed to update contact for order 1[39m
Update failed
[31m[Nest] 8232  - [39m02/12/2025, 9:57:04 a.¬†m. [31m  ERROR[39m [38;5;3m[WooCommerceSyncService] [39m[31mFatal error during customer sync[39m
Error: API failure
    at C:\Users\Ian Casta√±o\antigravity\mannaiah\src\features\contacts\woocommerce\woocommerce-sync.service.spec.ts:406:34
    at Observable.init [as _subscribe] (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\observable\throwError.ts:123:68)
    at Observable._trySubscribe (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\Observable.ts:235:19)
    at C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\Observable.ts:225:18
    at Object.errorContext (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\util\errorContext.ts:29:5)
    at Observable.subscribe (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\Observable.ts:211:5)
    at C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\operators\switchMap.ts:99:12
    at OperatorSubscriber.<anonymous> (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\util\lift.ts:24:18)
    at C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\Observable.ts:217:22
    at Object.errorContext (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\util\errorContext.ts:29:5)
    at Observable.subscribe (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\Observable.ts:211:5)
    at C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\operators\map.ts:53:12
    at OperatorSubscriber.<anonymous> (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\util\lift.ts:24:18)
    at C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\Observable.ts:217:22
    at Object.errorContext (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\util\errorContext.ts:29:5)
    at Observable.subscribe (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\Observable.ts:211:5)
    at C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\operators\catchError.ts:113:23
    at SafeSubscriber.<anonymous> (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\util\lift.ts:24:18)
    at C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\Observable.ts:217:22
    at Object.errorContext (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\util\errorContext.ts:29:5)
    at Observable.subscribe (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\rxjs\src\internal\Observable.ts:211:5)
    at Object.<anonymous> (C:\Users\Ian Casta√±o\antigravity\mannaiah\src\features\contacts\woocommerce\woocommerce-sync.service.spec.ts:409:37)
    at Promise.finally.completed (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-circus\build\jestAdapterInit.js:1549:26)
    at new Promise (<anonymous>)
    at callAsyncCircusFn (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-circus\build\jestAdapterInit.js:1497:10)
    at _callCircusTest (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-circus\build\jestAdapterInit.js:1007:40)
    at _runTest (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-circus\build\jestAdapterInit.js:947:3)
    at C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-circus\build\jestAdapterInit.js:849:7
    at _runTestsForDescribeBlock (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-circus\build\jestAdapterInit.js:862:11)
    at _runTestsForDescribeBlock (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-circus\build\jestAdapterInit.js:857:11)
    at _runTestsForDescribeBlock (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-circus\build\jestAdapterInit.js:857:11)
    at run (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-circus\build\jestAdapterInit.js:761:3)
    at runAndTransformResultsToJestFormat (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-circus\build\jestAdapterInit.js:1918:21)
    at jestAdapter (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-circus\build\runner.js:101:19)
    at runTestInternal (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-runner\build\index.js:275:16)
    at runTest (C:\Users\Ian Casta√±o\antigravity\mannaiah\node_modules\jest-runner\build\index.js:343:7)
[31m[Nest] 8232  - [39m02/12/2025, 9:57:04 a.¬†m. [31m  ERROR[39m [38;5;3m[WooCommerceSyncService] [39m[31mFailed to create contact for order 1[39m
Some other database error
FAIL src/features/contacts/woocommerce/woocommerce-sync.service.spec.ts (15.724 s)
  WooCommerceSyncService
    ‚àö should be defined (8 ms)
    syncCustomers
      ‚àö should process orders and create new contacts (4 ms)
      ‚àö should update existing contacts if changed (2 ms)
      ‚àö should not update if contact is unchanged (4 ms)
      ‚àö should handle errors gracefully (3 ms)
    phone formatting
      ‚àö should format phone with +57 prefix (2 ms)
      ‚àö should remove existing +57 before adding it back (1 ms)
    data extraction and mapping
      ‚àö should extract document number from metadata (2 ms)
      ‚àö should map billing data correctly (1 ms)
      ‚àö should create contact even without document number (1 ms)
      √ó should skip order missing email (5006 ms)
    contact creation
      ‚àö should create new contact when not exists (2 ms)
      ‚àö should handle creation errors gracefully (2 ms)
    contact update
      ‚àö should update contact when data has changed (1 ms)
      ‚àö should not update contact when data is unchanged (1 ms)
      ‚àö should handle update errors gracefully (1 ms)
    sync statistics
      √ó should return accurate statistics for mixed operations (5005 ms)
      ‚àö should handle empty orders list (2 ms)
    error handling
      ‚àö should handle fatal errors during sync (2 ms)
    duplicate key error handling
      ‚àö should handle E11000 duplicate key error and retry as update (1 ms)
      ‚àö should update on duplicate key error if contact data changed (1 ms)
      ‚àö should handle non-duplicate errors normally (1 ms)
    email deduplication
      ‚àö should deduplicate orders with same email (1 ms)
      ‚àö should process orders with different emails separately
      ‚àö should handle case-insensitive email deduplication (2 ms)
      √ó should skip orders without email in deduplication (5013 ms)
    race condition prevention
      ‚àö should process multiple orders with same email without race condition (2 ms)

  ‚óè WooCommerceSyncService ‚Ä∫ data extraction and mapping ‚Ä∫ should skip order missing email

    thrown: "Exceeded timeout of 5000 ms for a test while waiting for `done()` to be called.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 271 |[39m         })
     [90m 272 |[39m
    [31m[1m>[22m[39m[90m 273 |[39m         it([32m'should skip order missing email'[39m[33m,[39m (done) [33m=>[39m {
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 274 |[39m             [36mconst[39m orderWithoutEmail [33m=[39m {
     [90m 275 |[39m                 [33m...[39mmockOrder[33m,[39m
     [90m 276 |[39m                 billing[33m:[39m { [33m...[39mmockOrder[33m.[39mbilling[33m,[39m email[33m:[39m [32m''[39m }[33m,[39m[0m

      at features/contacts/woocommerce/woocommerce-sync.service.spec.ts:273:9
      at features/contacts/woocommerce/woocommerce-sync.service.spec.ts:210:5
      at Object.<anonymous> (features/contacts/woocommerce/woocommerce-sync.service.spec.ts:8:1)

  ‚óè WooCommerceSyncService ‚Ä∫ sync statistics ‚Ä∫ should return accurate statistics for mixed operations

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

    [0m [90m 385 |[39m                 expect(stats[33m.[39mtotal)[33m.[39mtoBe([35m3[39m)
     [90m 386 |[39m                 expect(stats[33m.[39mcreated)[33m.[39mtoBe([35m2[39m)
    [31m[1m>[22m[39m[90m 387 |[39m                 expect(stats[33m.[39merrors)[33m.[39mtoBe([35m1[39m)
     [90m     |[39m                                      [31m[1m^[22m[39m
     [90m 388 |[39m                 done()
     [90m 389 |[39m             })
     [90m 390 |[39m         })[0m

      at Object.next (features/contacts/woocommerce/woocommerce-sync.service.spec.ts:387:38)
      at ConsumerObserver.next (../node_modules/rxjs/src/internal/Subscriber.ts:155:25)
      at SafeSubscriber.Subscriber._next (../node_modules/rxjs/src/internal/Subscriber.ts:113:22)
      at SafeSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at OperatorSubscriber.Subscriber._next (../node_modules/rxjs/src/internal/Subscriber.ts:113:22)
      at OperatorSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at ../node_modules/rxjs/src/internal/operators/map.ts:57:20
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at ../node_modules/rxjs/src/internal/operators/switchMap.ts:114:42
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at ../node_modules/rxjs/src/internal/operators/map.ts:57:20
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at OperatorSubscriber.onFinalize (../node_modules/rxjs/src/internal/observable/forkJoin.ts:174:28)
      at OperatorSubscriber.unsubscribe (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:109:33)
      at OperatorSubscriber._this._complete (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:98:18)
      at OperatorSubscriber.Subscriber.complete (../node_modules/rxjs/src/internal/Subscriber.ts:100:12)
      at OperatorSubscriber.Subscriber._complete (../node_modules/rxjs/src/internal/Subscriber.ts:126:24)
      at OperatorSubscriber.Subscriber.complete (../node_modules/rxjs/src/internal/Subscriber.ts:100:12)
      at checkComplete (../node_modules/rxjs/src/internal/operators/switchMap.ts:97:78)
      at ../node_modules/rxjs/src/internal/operators/switchMap.ts:127:11
      at OperatorSubscriber._this._complete (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:92:13)
      at OperatorSubscriber.Subscriber.complete (../node_modules/rxjs/src/internal/Subscriber.ts:100:12)
      at OperatorSubscriber.Subscriber._complete (../node_modules/rxjs/src/internal/Subscriber.ts:126:24)
      at OperatorSubscriber.Subscriber.complete (../node_modules/rxjs/src/internal/Subscriber.ts:100:12)
      at Observable._subscribe (../node_modules/rxjs/src/internal/observable/innerFrom.ts:80:16)
      at Observable._trySubscribe (../node_modules/rxjs/src/internal/Observable.ts:235:19)
      at ../node_modules/rxjs/src/internal/Observable.ts:225:18
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/map.ts:53:12
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/switchMap.ts:99:12
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/catchError.ts:113:23
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at _loop_1 (../node_modules/rxjs/src/internal/observable/forkJoin.ts:159:39)
      at Observable._subscribe (../node_modules/rxjs/dist/cjs/internal/observable/forkJoin.js:45:13)
      at Observable._trySubscribe (../node_modules/rxjs/src/internal/Observable.ts:235:19)
      at ../node_modules/rxjs/src/internal/Observable.ts:225:18
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/map.ts:53:12
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/switchMap.ts:108:49
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at Observable._subscribe (../node_modules/rxjs/src/internal/observable/innerFrom.ts:78:18)
      at Observable._trySubscribe (../node_modules/rxjs/src/internal/Observable.ts:235:19)
      at ../node_modules/rxjs/src/internal/Observable.ts:225:18
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/switchMap.ts:99:12
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/map.ts:53:12
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/catchError.ts:113:23
      at SafeSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at Object.<anonymous> (features/contacts/woocommerce/woocommerce-sync.service.spec.ts:384:37)

  ‚óè WooCommerceSyncService ‚Ä∫ sync statistics ‚Ä∫ should return accurate statistics for mixed operations

    thrown: "Exceeded timeout of 5000 ms for a test while waiting for `done()` to be called.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 371 |[39m
     [90m 372 |[39m     describe([32m'sync statistics'[39m[33m,[39m () [33m=>[39m {
    [31m[1m>[22m[39m[90m 373 |[39m         it([32m'should return accurate statistics for mixed operations'[39m[33m,[39m (done) [33m=>[39m {
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 374 |[39m             [36mconst[39m orders [33m=[39m [
     [90m 375 |[39m                 mockOrder[33m,[39m [90m// Create[39m
     [90m 376 |[39m                 { [33m...[39mmockOrder[33m,[39m id[33m:[39m [35m2[39m[33m,[39m billing[33m:[39m { [33m...[39mmockOrder[33m.[39mbilling[33m,[39m email[33m:[39m [32m'jane@example.com'[39m }[33m,[39m meta_data[33m:[39m [{ id[33m:[39m [35m2[39m[33m,[39m key[33m:[39m [32m'_billing_document'[39m[33m,[39m value[33m:[39m [32m'987654321'[39m }] }[33m,[39m [90m// Create[39m[0m

      at features/contacts/woocommerce/woocommerce-sync.service.spec.ts:373:9
      at features/contacts/woocommerce/woocommerce-sync.service.spec.ts:372:5
      at Object.<anonymous> (features/contacts/woocommerce/woocommerce-sync.service.spec.ts:8:1)

  ‚óè WooCommerceSyncService ‚Ä∫ email deduplication ‚Ä∫ should skip orders without email in deduplication

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

    [0m [90m 547 |[39m                 expect(stats[33m.[39mtotal)[33m.[39mtoBe([35m3[39m)
     [90m 548 |[39m                 expect(stats[33m.[39mcreated)[33m.[39mtoBe([35m2[39m) [90m// Two valid emails[39m
    [31m[1m>[22m[39m[90m 549 |[39m                 expect(stats[33m.[39merrors)[33m.[39mtoBe([35m1[39m) [90m// One missing email[39m
     [90m     |[39m                                      [31m[1m^[22m[39m
     [90m 550 |[39m                 done()
     [90m 551 |[39m             })
     [90m 552 |[39m         })[0m

      at Object.next (features/contacts/woocommerce/woocommerce-sync.service.spec.ts:549:38)
      at ConsumerObserver.next (../node_modules/rxjs/src/internal/Subscriber.ts:155:25)
      at SafeSubscriber.Subscriber._next (../node_modules/rxjs/src/internal/Subscriber.ts:113:22)
      at SafeSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at OperatorSubscriber.Subscriber._next (../node_modules/rxjs/src/internal/Subscriber.ts:113:22)
      at OperatorSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at ../node_modules/rxjs/src/internal/operators/map.ts:57:20
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at ../node_modules/rxjs/src/internal/operators/switchMap.ts:114:42
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at ../node_modules/rxjs/src/internal/operators/map.ts:57:20
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at OperatorSubscriber.onFinalize (../node_modules/rxjs/src/internal/observable/forkJoin.ts:174:28)
      at OperatorSubscriber.unsubscribe (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:109:33)
      at OperatorSubscriber._this._complete (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:98:18)
      at OperatorSubscriber.Subscriber.complete (../node_modules/rxjs/src/internal/Subscriber.ts:100:12)
      at OperatorSubscriber.Subscriber._complete (../node_modules/rxjs/src/internal/Subscriber.ts:126:24)
      at OperatorSubscriber.Subscriber.complete (../node_modules/rxjs/src/internal/Subscriber.ts:100:12)
      at checkComplete (../node_modules/rxjs/src/internal/operators/switchMap.ts:97:78)
      at ../node_modules/rxjs/src/internal/operators/switchMap.ts:127:11
      at OperatorSubscriber._this._complete (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:92:13)
      at OperatorSubscriber.Subscriber.complete (../node_modules/rxjs/src/internal/Subscriber.ts:100:12)
      at OperatorSubscriber.Subscriber._complete (../node_modules/rxjs/src/internal/Subscriber.ts:126:24)
      at OperatorSubscriber.Subscriber.complete (../node_modules/rxjs/src/internal/Subscriber.ts:100:12)
      at Observable._subscribe (../node_modules/rxjs/src/internal/observable/innerFrom.ts:80:16)
      at Observable._trySubscribe (../node_modules/rxjs/src/internal/Observable.ts:235:19)
      at ../node_modules/rxjs/src/internal/Observable.ts:225:18
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/map.ts:53:12
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/switchMap.ts:99:12
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/catchError.ts:113:23
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at _loop_1 (../node_modules/rxjs/src/internal/observable/forkJoin.ts:159:39)
      at Observable._subscribe (../node_modules/rxjs/dist/cjs/internal/observable/forkJoin.js:45:13)
      at Observable._trySubscribe (../node_modules/rxjs/src/internal/Observable.ts:235:19)
      at ../node_modules/rxjs/src/internal/Observable.ts:225:18
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/map.ts:53:12
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/switchMap.ts:108:49
      at OperatorSubscriber._this._next (../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts:70:13)
      at OperatorSubscriber.Subscriber.next (../node_modules/rxjs/src/internal/Subscriber.ts:71:12)
      at Observable._subscribe (../node_modules/rxjs/src/internal/observable/innerFrom.ts:78:18)
      at Observable._trySubscribe (../node_modules/rxjs/src/internal/Observable.ts:235:19)
      at ../node_modules/rxjs/src/internal/Observable.ts:225:18
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/switchMap.ts:99:12
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/map.ts:53:12
      at OperatorSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at ../node_modules/rxjs/src/internal/operators/catchError.ts:113:23
      at SafeSubscriber.<anonymous> (../node_modules/rxjs/src/internal/util/lift.ts:24:18)
      at ../node_modules/rxjs/src/internal/Observable.ts:217:22
      at Object.errorContext (../node_modules/rxjs/src/internal/util/errorContext.ts:29:5)
      at Observable.subscribe (../node_modules/rxjs/src/internal/Observable.ts:211:5)
      at Object.<anonymous> (features/contacts/woocommerce/woocommerce-sync.service.spec.ts:546:37)

  ‚óè WooCommerceSyncService ‚Ä∫ email deduplication ‚Ä∫ should skip orders without email in deduplication

    thrown: "Exceeded timeout of 5000 ms for a test while waiting for `done()` to be called.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 535 |[39m         })
     [90m 536 |[39m
    [31m[1m>[22m[39m[90m 537 |[39m         it([32m'should skip orders without email in deduplication'[39m[33m,[39m (done) [33m=>[39m {
     [90m     |[39m         [31m[1m^[22m[39m
     [90m 538 |[39m             [36mconst[39m order1 [33m=[39m { [33m...[39mmockOrder[33m,[39m id[33m:[39m [35m1[39m[33m,[39m billing[33m:[39m { [33m...[39mmockOrder[33m.[39mbilling[33m,[39m email[33m:[39m [32m'john@example.com'[39m } }
     [90m 539 |[39m             [36mconst[39m order2 [33m=[39m { [33m...[39mmockOrder[33m,[39m id[33m:[39m [35m2[39m[33m,[39m billing[33m:[39m { [33m...[39mmockOrder[33m.[39mbilling[33m,[39m email[33m:[39m [32m''[39m } }
     [90m 540 |[39m             [36mconst[39m order3 [33m=[39m { [33m...[39mmockOrder[33m,[39m id[33m:[39m [35m3[39m[33m,[39m billing[33m:[39m { [33m...[39mmockOrder[33m.[39mbilling[33m,[39m email[33m:[39m [32m'jane@example.com'[39m }[33m,[39m meta_data[33m:[39m [{ id[33m:[39m [35m3[39m[33m,[39m key[33m:[39m [32m'_billing_document'[39m[33m,[39m value[33m:[39m [32m'987654321'[39m }] }[0m

      at features/contacts/woocommerce/woocommerce-sync.service.spec.ts:537:9
      at features/contacts/woocommerce/woocommerce-sync.service.spec.ts:482:5
      at Object.<anonymous> (features/contacts/woocommerce/woocommerce-sync.service.spec.ts:8:1)

Test Suites: 1 failed, 1 total
Tests:       3 failed, 24 passed, 27 total
Snapshots:   0 total
Time:        15.76 s, estimated 16 s
Ran all test suites matching src/features/contacts/woocommerce/woocommerce-sync.service.spec.ts.
